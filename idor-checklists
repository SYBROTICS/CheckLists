# ğŸ§¾ Complete IDOR (Insecure Direct Object Reference) Checklist

---

## ğŸ§­ **PHASE 1: RECONNAISSANCE**

### ğŸ”¹ 1.1 Identify Potential IDOR Targets
Look for any references to internal objects or resources:

- [ ] URLs with IDs or object references:
  ```
  /user/123
  /invoice/456
  /profile?id=789
  ```
- [ ] Form fields or hidden inputs (e.g., user_id, account_id)
- [ ] API endpoints using IDs in paths or query params
- [ ] Mobile apps or JavaScript-heavy apps (use Burp proxy)
- [ ] File download/view endpoints (e.g., `GET /files/receipt123.pdf`)
- [ ] Email or phone number usage (e.g., `GET /user?email=user@example.com`)
- [ ] UUIDs, slugs, or usernames as identifiers

---

## ğŸ”¬ **PHASE 2: INITIAL TESTING**

### ğŸ”¹ 2.1 Manual ID Fuzzing
- [ ] Change ID to another valid one (e.g., `123 â†’ 124`)
- [ ] Try accessing another userâ€™s:
  - Profile
  - Orders
  - Messages
  - Files
  - Tickets
  - Account settings

### ğŸ”¹ 2.2 Observe Response Behavior
- [ ] Do you get the other user's data?
- [ ] Do you get an error (403, 401, 404)?
- [ ] Do you get redirected or logged out?
- [ ] Does nothing happen (silent failure)?

---

## ğŸ”§ **PHASE 3: AUTOMATED TESTING**

### ğŸ”¹ 3.1 Use Burp Suite Repeater
- [ ] Send request to Repeater and modify ID
- [ ] Compare response lengths, content, and status codes

### ğŸ”¹ 3.2 Use Burp Suite Intruder (for ID enumeration)
- [ ] Set payload positions (e.g., `/invoice/Â§123Â§`)
- [ ] Use numeric payload list or `Sniper` attack
- [ ] Monitor for different responses (especially `200 OK`)

### ğŸ”¹ 3.3 Use Authorize Plugin (Burp extension)
- [ ] Record baseline requests while authenticated as user A
- [ ] Replay same requests as user B (or unauthenticated)
- [ ] Identify unauthorized access (color-coded diffs)

---

## ğŸ§‘â€ğŸ’» **PHASE 4: AUTHORIZATION CONTEXT SWITCHING**

### ğŸ”¹ 4.1 Test as Multiple Roles:
- [ ] Admin â†’ Regular user
- [ ] Regular user â†’ Another user
- [ ] Unauthenticated â†’ Authenticated

### ğŸ”¹ 4.2 Session Token Reuse
- [ ] Try sending request with no `Authorization` header
- [ ] Try replacing session tokens with other usersâ€™ tokens
- [ ] Check if object access is token-bound

---

## ğŸ¯ **PHASE 5: TARGET-SPECIFIC IDOR VARIANTS**

### ğŸ”¹ 5.1 Vertical & Horizontal Privilege Escalation
- [ ] Can user escalate to admin?
- [ ] Can user act on behalf of another user?

### ğŸ”¹ 5.2 Mass Assignment IDOR
- [ ] Try sending extra parameters in JSON or form data:
  ```json
  {
    "email": "test@evil.com",
    "role": "admin"
  }
  ```
- [ ] Try modifying sensitive fields (`is_admin`, `user_id`)

### ğŸ”¹ 5.3 IDOR on File Access
- [ ] Test file download links:
  ```
  /download?file=report_001.pdf â†’ report_002.pdf
  /files/user_1_photo.jpg â†’ user_2_photo.jpg
  ```

### ğŸ”¹ 5.4 API-specific IDOR
- [ ] Try endpoints like:
  ```
  GET /api/users/123
  PUT /api/profile/123
  DELETE /api/messages/456
  ```
- [ ] Modify user_id or resource_id in API JSON body

---

## ğŸ› ï¸ **PHASE 6: POST-EXPLOITATION / REPORTING**

### ğŸ”¹ 6.1 Document Impact
- [ ] What data was accessed (PII, credentials, payment)?
- [ ] What level of account was affected?
- [ ] Is there lateral movement or privilege escalation?

### ğŸ”¹ 6.2 Take Screenshots or Burp Exports
- [ ] Response with unauthorized data
- [ ] Before & after request comparison
- [ ] Mark headers and tokens used

---

## ğŸ›¡ï¸ **PHASE 7: PREVENTION & REMEDIATION CHECKLIST**

| Defense Technique                  | Applied? âœ… |
|-----------------------------------|------------|
| Use server-side authorization checks on every request | âœ… |
| Do **not** rely solely on client-side checks         | âœ… |
| Bind sessions to user-specific access scopes         | âœ… |
| Avoid exposing direct object IDs (use indirect references or mappings) | âœ… |
| Implement Role-Based Access Control (RBAC)           | âœ… |
| Use UUIDs if needed, but still enforce permissions   | âœ… |
| Audit logs for abnormal ID usage                     | âœ… |

---

## ğŸ§° Recommended Tools for IDOR Testing

| Tool         | Purpose                        |
|--------------|--------------------------------|
| **Burp Suite**  | Manual & semi-automated testing |
| **Autorize**    | Role-based access testing     |
| **Postman**     | API manipulation              |
| **ffuf**, **dirsearch** | Resource enumeration  |
| **ZAP**, **Nikto** | Basic scanning             |

---

## ğŸ“ Bonus: Real-World Examples

- ğŸŸ¢ Accessing `/api/users/2` as user 1 reveals email and phone
- ğŸŸ¢ Downloading someone else's PDF invoice by guessing filename
- ğŸŸ¢ Changing `order_id` in a POST request shows another userâ€™s data

